<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="libs/jquery-1.8.3.min.js"></script>
    <script src="libs/underscore.js"></script>
    <script src="libs/backbone.js"></script>
    <script src="app/sync.js"></script>

    <script>
        (function($, Backbone) {
            $(function() {

                var TodoModel = Backbone.Model.extend({
                    url: '/rpc.php',
                    postParams: {
                      'fe_username': 'j.smith',
                      'fe_password': 'johnsmith'
                    },
                    methods: {
                        read:   'Todo.retrieve',
                        create: 'Todo.create',
                        delete: 'Todo.delete',
                        update: 'Todo.update'
                    }
                });

                var TodoCollection = Backbone.Collection.extend({
                    url: '/rpc.php',
                    model: TodoModel,
                    methods: {
                        read:   'Todo.retrieve'
                    }
                });

                var todoItem = new TodoModel();

                todoItem.set('title', 'Mit Hund Gassi gehen.');
                todoItem.set('done', '1');
                todoItem.save(null, {
                    success: function(model) {
                        console.log(model.get('id'));
                    },
                    error: function(model, fail) {
                        console.log(arguments);
                    }
                });

                var todoList = new TodoCollection();

                todoList.fetch({
                    success: function(collection) {
                        collection.forEach(function(model) {
                            console.log(model.get('title'));
                        });

                        console.log(collection.first().get('id'));

                        var first = collection.first();
                        first.set('title', 'UPDATE');
                        first.save();

                        var last = collection.last();
                        last.destroy();
                    }
                })
            });
        })(jQuery, Backbone);
    </script>
</head>
<body>


</body>
</html>